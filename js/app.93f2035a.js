(function(t){function e(e){for(var r,a,s=e[0],c=e[1],l=e[2],h=0,d=[];h<s.length;h++)a=s[h],Object.prototype.hasOwnProperty.call(i,a)&&i[a]&&d.push(i[a][0]),i[a]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);u&&u(e);while(d.length)d.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],r=!0,s=1;s<n.length;s++){var c=n[s];0!==i[c]&&(r=!1)}r&&(o.splice(e--,1),t=a(a.s=n[0]))}return t}var r={},i={app:0},o=[];function a(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=t,a.c=r,a.d=function(t,e,n){a.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)a.d(n,r,function(e){return t[e]}.bind(null,r));return n},a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,"a",e),e},a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},a.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var u=c;o.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"0f75":function(t,e,n){"use strict";n("4bf5")},"2fab":function(t,e,n){},4622:function(t,e,n){"use strict";n("d1b6")},"4bf5":function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function i(t,e,n,i,o,a){var s=Object(r["n"])("grid");return Object(r["l"])(),Object(r["g"])("main",null,[Object(r["i"])(s)])}var o=n("b5fb"),a=n.n(o),s=n("b7d8"),c=n.n(s),l={class:"game-wrapper"},u={class:"control-panel"},h={class:"scores"},d={class:"control-buttons"},f=Object(r["h"])("img",{src:a.a,alt:"Back",title:"Back"},null,-1),v={class:"history-length"},b=Object(r["h"])("img",{src:c.a,alt:"Restart",title:"Restart"},null,-1),g=[b],p={class:"grid-layout"};function m(t,e,n,i,o,a){var s=Object(r["n"])("Tile"),c=Object(r["n"])("Modal");return Object(r["l"])(),Object(r["g"])("div",l,[Object(r["h"])("div",u,[Object(r["h"])("div",h,[Object(r["h"])("div",null,"Max Score: "+Object(r["o"])(a.getMaxScore()),1),Object(r["h"])("div",null,"Score: "+Object(r["o"])(o.controller.score),1)]),Object(r["h"])("div",d,[Object(r["h"])("button",{class:"control-button back-button",onClick:e[0]||(e[0]=function(){return a.back&&a.back.apply(a,arguments)})},[f,Object(r["h"])("div",v,Object(r["o"])(o.history.length),1)]),Object(r["h"])("button",{class:"control-button",onClick:e[1]||(e[1]=function(){return a.restart&&a.restart.apply(a,arguments)})},g)])]),Object(r["h"])("div",p,[(Object(r["l"])(!0),Object(r["g"])(r["a"],null,Object(r["m"])(a.grid,(function(t,e){return Object(r["l"])(),Object(r["g"])("div",{key:e,class:"grid-layout__row"},[(Object(r["l"])(!0),Object(r["g"])(r["a"],null,Object(r["m"])(t,(function(t,e){return Object(r["l"])(),Object(r["g"])("div",{key:e,class:"grid-layout__cell"})})),128))])})),128))]),Object(r["h"])("div",{class:Object(r["j"])(["grid",{backwards:o.backwards,restarting:o.restarting}])},[(Object(r["l"])(!0),Object(r["g"])(r["a"],null,Object(r["m"])(a.tiles,(function(t){return Object(r["l"])(),Object(r["e"])(s,{key:t.id,tile:t},null,8,["tile"])})),128))],2),Object(r["i"])(c,{show:o.gameOver,onRestart:a.restart,text:"Game Over",alternative:"Back",onAlternative:a.back},null,8,["show","onRestart","onAlternative"]),Object(r["i"])(c,{show:o.hasWon,onRestart:a.restart,text:"You Won",alternative:"Continue",onAlternative:e[2]||(e[2]=function(t){return o.hasWon=!1})},null,8,["show","onRestart"])])}n("e9c4"),n("cb29"),n("99af"),n("fb6a"),n("d3b7"),n("ddb0"),n("0481"),n("4069");var y=n("b85c"),O=n("2909"),j=n("d4ec"),k=n("bee2"),w=n("ade3"),x=(n("4de4"),n("d81d"),n("159b"),n("7db0"),function(t){return{value:0,changed:!1,moved:!1,index:t}}),S=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],_=function(){var t=0;return S.map((function(e){return e.map((function(){return x(t++)}))}))},L=function(){function t(){var e=this;Object(j["a"])(this,t),Object(w["a"])(this,"keyUp",(function(){for(var t in e._grid[0])e.moveUpAtCol(t)})),Object(w["a"])(this,"keyDown",(function(){for(var t in e._grid[0])e.moveDownAtCol(t)})),Object(w["a"])(this,"keyLeft",(function(){for(var t in e._grid)e.moveLeftAtRow(t)})),Object(w["a"])(this,"keyRight",(function(){for(var t in e._grid)e.moveRightAtRow(t)})),this._grid=_(),this.nextId=0,this.score=0,this.tiles=[]}return Object(k["a"])(t,[{key:"grid",get:function(){return this._grid},set:function(t){this._grid=t}},{key:"fill",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:2,e=0;e<t;e++)this.createRandomCell()}},{key:"createRandomCell",value:function(){var t=this.choice(this.availableCells).index,e=this.flatGrid[t],n=Math.random()<.9?2:4;e.value=n,this.addTile(n,t)}},{key:"choice",value:function(t){return t[Math.floor(Math.random()*t.length)]}},{key:"availableCells",get:function(){return this.flatGrid.filter((function(t){return!t.value}))}},{key:"flatGrid",get:function(){return this._grid.flat()}},{key:"addTile",value:function(t,e){var n={value:t,index:e,delete:!1,isNew:!0,id:this.nextId++};this.tiles.push(n)}},{key:"getCol",value:function(t){return this._grid.map((function(e){return e[t]}))}},{key:"setCol",value:function(t,e){this._grid.forEach((function(n,r){n[t]=e[r]}))}},{key:"getRow",value:function(t){return Object(O["a"])(this._grid[t])}},{key:"setRow",value:function(t,e){this._grid[t]=e}},{key:"moveUpAtCol",value:function(t){var e=this.getCol(t);this.setCol(t,this.moveLine(e))}},{key:"moveDownAtCol",value:function(t){var e=this.getCol(t).reverse();this.setCol(t,this.moveLine(e).reverse())}},{key:"moveLeftAtRow",value:function(t){var e=this.getRow(t);this.setRow(t,this.moveLine(e))}},{key:"moveRightAtRow",value:function(t){var e=this.getRow(t).reverse();this.setRow(t,this.moveLine(e).reverse())}},{key:"moveLine",value:function(t){for(var e=this,n=function(n){var r=-1;if(0===t[n].value)return"continue";for(var i=n-1;i>=0;i--){if(0!==t[i].value&&t[i].value!==t[n].value||t[i].changed)break;r=i}if(!~r)return"continue";var o=t[r],a=e.tiles.find((function(e){return e.index===t[n].index}));o.value&&(o.changed=!0,e.mergeTiles(o,a)),o.value+=t[n].value,o.moved=!0,a.index=o.index,t[n].value=0},r=1;r<t.length;r++)n(r);return t}},{key:"mergeTiles",value:function(t,e){var n=this.tiles.find((function(e){return e.index===t.index}));n.delete=!0,e.delete=!0,this.addTile(2*t.value,t.index),this.score+=2*t.value}},{key:"clear",value:function(){var t,e=Object(y["a"])(this.flatGrid);try{for(e.s();!(t=e.n()).done;){var n=t.value;n.changed=!1,n.moved=!1}}catch(r){e.e(r)}finally{e.f()}this.tiles=this.tiles.filter((function(t){return!t.delete})),this.tiles.forEach((function(t){return t.isNew=!1}))}},{key:"restart",value:function(){var t=this;this.nextId=0,this.tiles=[],this._grid=_(),setTimeout((function(){t.fill()}),0),this.score=0}},{key:"replaceState",value:function(t){var e=t.grid,n=t.tiles,r=t.score,i=t.nextId;this._grid=e,this.tiles=n,this.score=r,this.nextId=null!==i&&void 0!==i?i:this.nextId}},{key:"restoreTiles",value:function(t){this.tiles=t.tiles}},{key:"hasLost",value:function(){if(this.availableCells.length)return!1;for(var t=0;t<this._grid.length;t++)for(var e=0;e<this._grid.length;e++){var n,r,i,o,a=this._grid[t][e].value;if(a===(null===(n=this._grid[t+1])||void 0===n||null===(r=n[e])||void 0===r?void 0:r.value)||a===(null===(i=this._grid[t])||void 0===i||null===(o=i[e+1])||void 0===o?void 0:o.value))return!1}return!0}},{key:"hasWon",value:function(){return this.tiles.some((function(t){return 2048===t.value}))}}]),t}(),R=function(){function t(e){Object(j["a"])(this,t),this.target=e,this.distance=25,this.dispatched=!1,this.startPoint={x:0,y:0},this.initListeners()}return Object(k["a"])(t,[{key:"initListeners",value:function(){var t=this;this.target.addEventListener("touchstart",(function(e){return t.handleStart(e)})),this.target.addEventListener("touchmove",(function(e){return t.handleMove(e)})),this.target.addEventListener("touchend",(function(){return t.dispatched=!1}))}},{key:"dispatchEvent",value:function(t){var e=new CustomEvent("custom:swipe",{detail:{direction:t}});this.target.dispatchEvent(e),this.dispatched=!0}},{key:"handleStart",value:function(t){this.startPoint.x=t.touches[0].clientX,this.startPoint.y=t.touches[0].clientY}},{key:"handleMove",value:function(t){if(!this.dispatched){var e=t.touches[0],n=e.clientX,r=e.clientY,i=n-this.startPoint.x,o=r-this.startPoint.y;Math.abs(i)>Math.abs(o)?this.compareAndDispatch(i,"right","left"):this.compareAndDispatch(o,"down","up")}}},{key:"compareAndDispatch",value:function(t,e,n){t>this.distance?this.dispatchEvent(e):-t>this.distance&&this.dispatchEvent(n)}}]),t}(),C={getFromLocalStorage:function(t){return JSON.parse(localStorage.getItem(t))},setToLocalStorage:function(t,e){localStorage.setItem(t,JSON.stringify(e))},get history(){return this.getFromLocalStorage("2048-history")||[]},set history(t){this.setToLocalStorage("2048-history",t)},get lastState(){var t,e=this.getFromLocalStorage("2048-last-state");return null===e||void 0===e||null===(t=e.tiles)||void 0===t||t.forEach((function(t){return t.isNew=!1})),e},set lastState(t){this.setToLocalStorage("2048-last-state",t)},get maxScore(){return this.getFromLocalStorage("2048-max-score")||0},set maxScore(t){this.setToLocalStorage("2048-max-score",t)},get hasWon(){return this.getFromLocalStorage("2048-won")},set hasWon(t){this.setToLocalStorage("2048-won",t)}};function A(t,e,n,i,o,a){return Object(r["l"])(),Object(r["g"])("div",{class:"grid-tile",style:Object(r["k"])(a.pos)},[Object(r["i"])(r["c"],{name:"tile",appear:""},{default:Object(r["p"])((function(){return[Object(r["h"])("div",{class:Object(r["j"])(["tile-inner",a.className]),style:Object(r["k"])(a.color)},Object(r["o"])(n.tile.value),7)]})),_:1})],4)}var M={data:function(){return{colors:{2:"#eee",4:"#fff3dd",8:"#feddb1",16:"#fed39c",32:"#fdd08c",64:"#ffc87d",128:"#fec16e",256:"#ffb972",512:"#fba877",1024:"#ff9182",2048:"#ff7070"}}},props:{tile:Object},computed:{pos:function(){return"\n        transform: translate(".concat(this.tile.index%4*100,"%, ").concat(100*Math.floor(this.tile.index/4),"%)")},className:function(){return{new:this.tile.isNew,merged:this.tile.delete}},color:function(){var t=this.colors[this.tile.value]||"#8758ff";return this.tile.value<2048?"background-color: ".concat(t):"background-color: ".concat(t,"; color: white")}}},T=(n("4622"),n("6b0d")),E=n.n(T);const W=E()(M,[["render",A]]);var N=W,P={key:0,class:"modal"},I={class:"modal__text"},D={class:"modal__buttons"},G=Object(r["h"])("div",{class:"backdrop"},null,-1);function J(t,e,n,i,o,a){return Object(r["l"])(),Object(r["e"])(r["b"],{to:"body"},[Object(r["i"])(r["c"],{name:"modal"},{default:Object(r["p"])((function(){return[n.show?(Object(r["l"])(),Object(r["g"])("div",P,[Object(r["h"])("div",I,Object(r["o"])(n.text),1),Object(r["h"])("div",D,[Object(r["h"])("button",{class:"modal__button modal__restart-button",onClick:e[0]||(e[0]=function(e){return t.$emit("restart")})}," Restart "),Object(r["h"])("button",{class:"modal__button",onClick:e[1]||(e[1]=function(e){return t.$emit("alternative")})},Object(r["o"])(n.alternative),1)]),G])):Object(r["f"])("",!0)]})),_:1})])}var F={props:{text:String,show:Boolean,alternative:String},emits:["restart","alternative"]};n("aa21");const U=E()(F,[["render",J]]);var B=U,Y={components:{Tile:N,Modal:B},data:function(){var t=new L;return new R(document),{keys:{ArrowUp:t.keyUp,ArrowDown:t.keyDown,ArrowLeft:t.keyLeft,ArrowRight:t.keyRight},controller:t,gameOver:!1,hasWon:!1,backwards:!1,restarting:!1,history:[]}},methods:{restart:function(){this.gameOver=!1,this.hasWon=!1,this.backwards=!1,this.restarting=!0,this.controller.restart(),this.history=[],C.hasWon=!1},back:function(){var t=this.history.pop();void 0!==t&&(this.backwards=!0,this.gameOver=!1,this.controller.replaceState(t))},copyState:function(){return{grid:JSON.parse(JSON.stringify(this.grid)),tiles:JSON.parse(JSON.stringify(this.tiles)),score:this.controller.score}},updateHistory:function(t){5===this.history.length&&this.history.shift(),this.history.push(t)},loadFromStorage:function(){var t=C.lastState;t&&t.tiles.length?this.controller.replaceState(t):this.controller.fill(),this.history=C.history},getMaxScore:function(){return Math.max(C.maxScore,this.controller.score)},swipe:function(t){var e=t.direction,n="Arrow".concat(e[0].toUpperCase()).concat(e.slice(1));this.move(n)},move:function(t){if(this.keys[t]){var e=this.copyState();if(this.backwards=!1,this.restarting=!1,this.controller.clear(),this.keys[t](),!this.flatGrid.some((function(t){return t.moved})))return this.controller.restoreTiles(e);this.controller.fill(1),this.updateHistory(e),this.controller.hasLost()&&(this.gameOver=!0),!C.hasWon&&this.controller.hasWon()&&(this.hasWon=!0,C.hasWon=!0)}}},watch:{history:{handler:function(){C.maxScore=this.getMaxScore(),C.history=this.history,C.lastState={grid:this.grid,tiles:this.tiles,score:this.controller.score,nextId:this.controller.nextId}},deep:!0}},computed:{grid:function(){return this.controller.grid},flatGrid:function(){return this.grid.flat()},tiles:function(){return this.controller.tiles}},created:function(){var t=this;this.loadFromStorage(),document.addEventListener("keydown",(function(e){var n=e.key;return t.move(n)})),document.addEventListener("keydown",(function(e){var n=e.key.toLowerCase();!e.ctrlKey||"z"!==n&&"я"!==n||t.back()})),document.addEventListener("custom:swipe",(function(e){var n=e.detail;return t.swipe(n)}))}};n("0f75");const H=E()(Y,[["render",m]]);var X=H,$={name:"App",components:{Grid:X}};n("b63c");const z=E()($,[["render",i]]);var K=z;Object(r["d"])(K).mount("#app")},aa21:function(t,e,n){"use strict";n("dcf0")},b5fb:function(t,e,n){t.exports=n.p+"img/arrow-back.58ce96a0.svg"},b63c:function(t,e,n){"use strict";n("2fab")},b7d8:function(t,e,n){t.exports=n.p+"img/refresh.a26ba739.svg"},d1b6:function(t,e,n){},dcf0:function(t,e,n){}});
//# sourceMappingURL=app.93f2035a.js.map